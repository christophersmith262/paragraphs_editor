services:
  paragraphs_ckeditor.command.context_access:
    class: Drupal\paragraphs_ckeditor\Access\ContextAccessCheck
    arguments: ['@entity_type.manager']
    tags:
      - { name: access_check, applies_to: _paragraphs_ckeditor_access_context }
  paragraphs_ckeditor.command.paragraph_access:
    class: Drupal\paragraphs_ckeditor\Access\ParagraphAccessCheck
    arguments: ['@paragraphs_ckeditor.edit_buffer.item_factory']
    tags:
      - { name: access_check, applies_to: _paragraphs_ckeditor_access_paragraph }
  paragraphs_ckeditor.command.context_converter:
    class: Drupal\paragraphs_ckeditor\ParamConverter\CommandContextConverter
    arguments: ['@request_stack', '@paragraphs_ckeditor.command.context_factory']
    tags:
      - { name: paramconverter }
  paragraphs_ckeditor.command.context_factory:
    class: Drupal\paragraphs_ckeditor\EditorCommand\CommandContextFactory
    arguments: 
      - '@entity_type.manager'
      - '@paragraphs_ckeditor.edit_buffer.cache'
      - '@paragraphs_ckeditor.delivery_provider.manager'
      - '@paragraphs_ckeditor.bundle_selector.manager'
  paragraphs_ckeditor.command.response_handler:
    class: Drupal\paragraphs_ckeditor\EditorCommand\ResponseHandler
    arguments: ['@form_builder', '@entity_type.manager', '@module_handler', '@entity.manager']
  paragraphs_ckeditor.edit_buffer.cache:
    class: Drupal\paragraphs_ckeditor\EditBuffer\EditBufferCache
    arguments: ['@keyvalue.expirable', '%paragraphs_ckeditor.edit_buffer.cache.lifetime%', '@current_user']
  paragraphs_ckeditor.edit_buffer.item_factory:
    class: Drupal\paragraphs_ckeditor\EditBuffer\EditBufferItemFactory
    arguments: ['@entity_type.manager']
  paragraphs_ckeditor.delivery_provider.manager:
    class: Drupal\paragraphs_ckeditor\Plugin\ParagraphsCKEditor\PluginManager
    arguments: [delivery_provider, '@container.namespaces', '@cache.discovery', '@module_handler']
  paragraphs_ckeditor.bundle_selector.manager:
    class: Drupal\paragraphs_ckeditor\Plugin\ParagraphsCKEditor\PluginManager
    arguments: [bundle_selector, '@container.namespaces', '@cache.discovery', '@module_handler']
  paragraphs_ckeditor.field_value.text_bundle_manager:
    class: Drupal\paragraphs_ckeditor\EditorFieldValue\TextBundleManager
    arguments: ['@entity_field.manager', '@entity_type.manager']
  paragraphs_ckeditor.field_value.embed_code_processor:
    class: Drupal\paragraphs_ckeditor\EditorFieldValue\EmbedCodeProcessor
    arguments: ['%paragraphs_ckeditor.field_value.embed_template%']
  paragraphs_ckeditor.field_value.manager:
    class: Drupal\paragraphs_ckeditor\EditorFieldValue\FieldValueManager
    arguments: ['@entity_type.manager', '@paragraphs_ckeditor.field_value.embed_code_processor']

parameters:
  paragraphs_ckeditor.edit_buffer.cache.lifetime: 24000
  paragraphs_ckeditor.field_value.embed_template:
    tag: paragraphs-ckeditor-paragraph
    close: TRUE
    attributes:
      uuid: data-paragraph-uuid
      context: data-context-hint
